<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brutal Pusher - Stop Procrastinating!</title>
    <meta name="description" content="A brutal but humorous anti-procrastination tool">
    <meta name="theme-color" content="#dc2626">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Styles -->
    <style>
        .brutal-button {
            @apply bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg 
                   transform hover:scale-105 transition-all duration-200 shadow-lg;
        }
        
        .brutal-card {
            @apply bg-white rounded-xl shadow-lg border-2 border-orange-500 p-6;
        }
        
        .brutal-text {
            @apply text-red-600 font-bold text-lg;
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .pulse-brutal {
            animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #fef2f2 0%, #fed7aa 100%);
        }
        
        .step-item {
            @apply flex items-start gap-3 p-3 bg-orange-50 rounded-lg cursor-pointer transition-all duration-200 hover:bg-orange-100 border-2 border-orange-200;
        }
        
        .step-item.completed {
            @apply bg-green-50 border-green-300 opacity-75;
        }
        
        .step-item.completed .step-text {
            @apply line-through text-gray-500;
        }
        
        .step-item.completed .step-number {
            @apply bg-green-500;
        }

        .loading {
            @apply animate-pulse;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-red-600 mb-2">
                💀 Brutal Pusher 💀
            </h1>
            <p class="text-gray-600">Stop procrastinating, you lazy potato! 🥔</p>
        </header>

        <!-- Main Content -->
        <main class="max-w-3xl mx-auto space-y-6">
            <!-- Task Input Section -->
            <div class="brutal-card">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-white text-2xl">🎯</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">
                        What do you want to accomplish?
                    </h2>
                    <p class="text-gray-600">
                        Tell me what you're procrastinating on, you magnificent slacker! 😤
                    </p>
                </div>

                <form id="taskForm" class="space-y-4">
                    <div>
                        <textarea
                            id="taskInput"
                            placeholder="I want to... (be specific, you lazy human!)"
                            class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-red-600 focus:outline-none resize-none"
                            rows="3"
                            required
                        ></textarea>
                    </div>
                    
                    <button
                        type="submit"
                        id="submitBtn"
                        class="brutal-button w-full flex items-center justify-center gap-2"
                    >
                        <span id="submitText">⚡ Generate my brutal plan!</span>
                        <span id="loadingText" class="hidden">🤖 AI is thinking...</span>
                    </button>
                </form>
            </div>

            <!-- Motivation Section -->
            <div id="motivationSection" class="brutal-card hidden fade-in">
                <div class="text-center mb-4">
                    <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-3">
                        <span class="text-white text-xl">🔥</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-3">
                        Your Brutal Motivation
                    </h3>
                </div>
                
                <div id="motivationText" class="bg-red-50 border-2 border-red-600 rounded-lg p-4">
                    <p class="text-lg font-semibold text-red-600 leading-relaxed">
                        <!-- Motivation will be populated by AI -->
                    </p>
                </div>
            </div>

            <!-- Progress Section -->
            <div id="progressSection" class="brutal-card hidden fade-in">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                        <span class="text-yellow-500">🏆</span>
                        Progress Tracker
                    </h3>
                    <div class="text-right">
                        <div id="timer" class="text-2xl font-bold text-red-600">
                            00:00:00
                        </div>
                        <div class="text-sm text-gray-600">Time spent</div>
                    </div>
                </div>

                <div class="space-y-3 mb-4">
                    <div class="flex justify-between text-sm">
                        <span>Progress</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div 
                            id="progressBar"
                            class="bg-red-600 h-3 rounded-full transition-all duration-300"
                            style="width: 0%"
                        ></div>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button
                        id="pauseBtn"
                        class="flex-1 brutal-button"
                    >
                        ⏸️ Pause
                    </button>
                    <button
                        id="restartBtn"
                        class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors"
                    >
                        🔄 New Task
                    </button>
                </div>
            </div>

            <!-- Steps Section -->
            <div id="stepsSection" class="brutal-card hidden fade-in">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="text-orange-500">✅</span>
                    Your Action Plan
                </h3>
                
                <div id="stepsList" class="space-y-3">
                    <!-- Steps will be populated by AI -->
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        // Global state
        let taskData = {
            task: '',
            breakdown: [],
            motivation: ''
        };
        let timer = null;
        let timeElapsed = 0;
        let isTimerRunning = true;
        let completedSteps = [];

        // Debug function
        function debug(message) {
            console.log('🔍 Debug:', message);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            debug('App initialized');
            setupEventListeners();
            debug('Setup complete');
        });

        function setupEventListeners() {
            debug('Setting up event listeners');
            
            // Task form
            const taskForm = document.getElementById('taskForm');
            if (taskForm) {
                taskForm.addEventListener('submit', function(e) {
                    debug('Task form submitted');
                    handleTaskSubmit(e);
                });
            } else {
                console.error('❌ taskForm not found!');
            }
            
            // Progress controls
            const pauseBtn = document.getElementById('pauseBtn');
            if (pauseBtn) {
                pauseBtn.addEventListener('click', function() {
                    debug('Pause button clicked');
                    toggleTimer();
                });
            } else {
                console.error('❌ pauseBtn not found!');
            }
            
            const restartBtn = document.getElementById('restartBtn');
            if (restartBtn) {
                restartBtn.addEventListener('click', function() {
                    debug('Restart button clicked');
                    restartApp();
                });
            } else {
                console.error('❌ restartBtn not found!');
            }
            
            debug('Event listeners setup complete');
        }

        function handleTaskSubmit(e) {
            e.preventDefault();
            debug('Handling task submit');
            
            const taskInput = document.getElementById('taskInput');
            if (!taskInput) {
                console.error('❌ taskInput not found!');
                return;
            }
            
            const task = taskInput.value.trim();
            debug('Task entered: ' + task);
            
            if (task) {
                taskData.task = task;
                showLoading(true);
                generateAIPlan(task);
            } else {
                debug('No task entered');
                alert('Come on, you lazy potato! Enter something! 🥔');
            }
        }

        function showLoading(show) {
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const loadingText = document.getElementById('loadingText');
            
            if (show) {
                submitBtn.disabled = true;
                submitText.classList.add('hidden');
                loadingText.classList.remove('hidden');
                submitBtn.classList.add('loading');
            } else {
                submitBtn.disabled = false;
                submitText.classList.remove('hidden');
                loadingText.classList.add('hidden');
                submitBtn.classList.remove('loading');
            }
        }

        async function generateAIPlan(task) {
            debug('Generating AI plan for: ' + task);
            
            try {
                // Call our backend API (you'll need to set this up)
                const response = await fetch('/api/generate-plan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ task: task })
                });

                if (response.ok) {
                    const data = await response.json();
                    taskData.motivation = data.motivation;
                    taskData.breakdown = data.steps;
                    debug('AI plan received');
                } else {
                    throw new Error('API call failed');
                }
            } catch (error) {
                console.error('API error:', error);
                debug('Using fallback plan');
                generateFallbackPlan(task);
            }
            
            showPlan();
        }

        function generateFallbackPlan(task) {
            debug('Generating fallback plan');
            
            // Generate brutal motivation
            const motivations = [
                `Listen here, you magnificent procrastinator! Your ${task} isn't going to do itself! Stop being a professional excuse maker and start being a goal achiever! 💀`,
                `Oh, you want to ${task}? Well, your future self is already disappointed in you! Time to stop being a couch potato and start being a success potato! 🚀`,
                `Your ${task} is waiting for you, but you're too busy being lazy! Your procrastination skills are impressive, but your achievement skills are non-existent! Time to change that! ⚡`,
                `Excuse me, but your ${task} doesn't care about your feelings! Stop making excuses and start making progress! Your goals are getting tired of waiting! 🥔`
            ];
            
            taskData.motivation = motivations[Math.floor(Math.random() * motivations.length)];
            
            // Generate custom steps based on task
            taskData.breakdown = generateCustomSteps(task);
        }

        function generateCustomSteps(task) {
            const taskLower = task.toLowerCase();
            
            if (taskLower.includes('study') || taskLower.includes('learn') || taskLower.includes('read')) {
                return [
                    'Clear your desk and remove all distractions',
                    'Open your textbook and read one chapter',
                    'Take notes on the key points',
                    'Review and summarize what you learned',
                    'Test yourself with practice questions'
                ];
            } else if (taskLower.includes('work') || taskLower.includes('project') || taskLower.includes('job')) {
                return [
                    'Check your email and prioritize tasks',
                    'Start with the most important task first',
                    'Set a timer for 25 minutes and focus',
                    'Take a 5-minute break, then continue',
                    'Review your progress and adjust'
                ];
            } else if (taskLower.includes('exercise') || taskLower.includes('workout') || taskLower.includes('gym')) {
                return [
                    'Put on your workout clothes',
                    'Do a 5-minute warm-up',
                    'Start with 10 minutes of cardio',
                    'Add strength training exercises',
                    'Cool down and stretch'
                ];
            } else if (taskLower.includes('clean') || taskLower.includes('organize') || taskLower.includes('tidy')) {
                return [
                    'Pick up trash and put it in the bin',
                    'Put away items that are out of place',
                    'Wipe down surfaces with a cloth',
                    'Vacuum or sweep the floor',
                    'Organize one drawer or shelf'
                ];
            } else if (taskLower.includes('write') || taskLower.includes('blog') || taskLower.includes('article')) {
                return [
                    'Open a blank document',
                    'Write down your main ideas',
                    'Start with the first paragraph',
                    'Keep writing without editing',
                    'Review and polish your work'
                ];
            } else {
                return [
                    'Break down your task into smaller parts',
                    'Start with the easiest step first',
                    'Set a timer for 25 minutes and focus',
                    'Take a short break and continue',
                    'Review your progress and celebrate small wins'
                ];
            }
        }

        function showPlan() {
            debug('Showing plan');
            showLoading(false);
            
            // Show all sections
            document.getElementById('motivationSection').classList.remove('hidden');
            document.getElementById('progressSection').classList.remove('hidden');
            document.getElementById('stepsSection').classList.remove('hidden');
            
            // Add fade-in animation
            setTimeout(() => {
                document.getElementById('motivationSection').classList.add('fade-in');
                document.getElementById('progressSection').classList.add('fade-in');
                document.getElementById('stepsSection').classList.add('fade-in');
            }, 100);
            
            displayMotivation();
            displaySteps();
            startTimer();
        }

        function displayMotivation() {
            debug('Displaying motivation');
            const motivationText = document.getElementById('motivationText');
            if (!motivationText) {
                console.error('❌ motivationText not found!');
                return;
            }
            
            motivationText.innerHTML = `<p class="text-lg font-semibold text-red-600 leading-relaxed">${taskData.motivation}</p>`;
            debug('Motivation displayed');
        }

        function displaySteps() {
            debug('Displaying steps');
            const stepsList = document.getElementById('stepsList');
            if (!stepsList) {
                console.error('❌ stepsList not found!');
                return;
            }
            
            stepsList.innerHTML = '';
            
            taskData.breakdown.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step-item slide-up';
                stepDiv.style.animationDelay = `${index * 0.1}s`;
                stepDiv.onclick = () => {
                    debug('Step clicked: ' + index);
                    toggleStep(index);
                };
                stepDiv.innerHTML = `
                    <span class="step-number bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">
                        ${index + 1}
                    </span>
                    <span class="step-text text-gray-700 flex-1">${step}</span>
                    <span class="text-gray-400 text-xl">✅</span>
                `;
                stepsList.appendChild(stepDiv);
            });
            debug('Steps displayed: ' + taskData.breakdown.length + ' steps');
        }

        function startTimer() {
            debug('Starting timer');
            timer = setInterval(() => {
                if (isTimerRunning) {
                    timeElapsed++;
                    updateTimer();
                }
            }, 1000);
        }

        function updateTimer() {
            const hours = Math.floor(timeElapsed / 3600);
            const minutes = Math.floor((timeElapsed % 3600) / 60);
            const seconds = timeElapsed % 60;
            
            const timerElement = document.getElementById('timer');
            if (timerElement) {
                timerElement.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        function toggleTimer() {
            isTimerRunning = !isTimerRunning;
            const pauseBtn = document.getElementById('pauseBtn');
            if (pauseBtn) {
                pauseBtn.innerHTML = isTimerRunning ? '⏸️ Pause' : '▶️ Resume';
            }
            debug('Timer toggled: ' + (isTimerRunning ? 'running' : 'paused'));
        }

        function toggleStep(index) {
            debug('Toggling step: ' + index);
            const stepItems = document.querySelectorAll('.step-item');
            const stepItem = stepItems[index];
            
            if (completedSteps.includes(index)) {
                completedSteps = completedSteps.filter(i => i !== index);
                stepItem.classList.remove('completed');
                stepItem.querySelector('.step-number').className = 'step-number bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold';
                stepItem.querySelector('.step-text').className = 'step-text text-gray-700 flex-1';
                debug('Step uncompleted: ' + index);
            } else {
                completedSteps.push(index);
                stepItem.classList.add('completed');
                stepItem.querySelector('.step-number').className = 'step-number bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold';
                stepItem.querySelector('.step-text').className = 'step-text text-gray-700 flex-1 line-through text-gray-500';
                debug('Step completed: ' + index);
            }
            
            updateProgress();
        }

        function updateProgress() {
            const progress = taskData.breakdown.length > 0 ? (completedSteps.length / taskData.breakdown.length) * 100 : 0;
            
            const progressPercent = document.getElementById('progressPercent');
            if (progressPercent) {
                progressPercent.textContent = `${Math.round(progress)}%`;
            }
            
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
            }
            
            debug('Progress updated: ' + Math.round(progress) + '%');
        }

        function restartApp() {
            debug('Restarting app');
            if (timer) {
                clearInterval(timer);
            }
            
            // Reset state
            taskData = { task: '', breakdown: [], motivation: '' };
            timeElapsed = 0;
            isTimerRunning = true;
            completedSteps = [];
            
            // Reset UI
            const taskInput = document.getElementById('taskInput');
            if (taskInput) taskInput.value = '';
            
            const timerElement = document.getElementById('timer');
            if (timerElement) timerElement.textContent = '00:00:00';
            
            const progressPercent = document.getElementById('progressPercent');
            if (progressPercent) progressPercent.textContent = '0%';
            
            const progressBar = document.getElementById('progressBar');
            if (progressBar) progressBar.style.width = '0%';
            
            // Hide sections
            document.getElementById('motivationSection').classList.add('hidden');
            document.getElementById('progressSection').classList.add('hidden');
            document.getElementById('stepsSection').classList.add('hidden');
            
            debug('App restarted');
        }

        // Add some helpful console messages
        console.log('💀 Brutal Pusher loaded!');
        console.log('🔍 Open browser console (F12) to see debug messages');
        console.log('📱 This is a PWA - you can install it on your phone!');
        console.log('🤖 AI-powered task breakdown - integrated with backend API');
    </script>
</body>
</html>
