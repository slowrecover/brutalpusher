<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brutal Pusher - Stop Procrastinating NOW</title>
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Brutal Pusher - Stop Procrastinating NOW">
    <meta property="og:description" content="Your savage AI friend who actually makes you get shit done">
    <meta property="og:url" content="https://brutalpusher.vercel.app">
    <meta property="og:type" content="website">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P009BV8WW7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-P009BV8WW7');
    </script>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Stop procrastinating with Brutal Pusher - The only AI productivity tool that doesn't baby you. Get brutal honesty about your procrastination habits.">
    <meta name="keywords" content="procrastination, productivity, brutal pusher, AI coach, time management, stop procrastinating, tough love, anti-procrastination tool">
    <meta name="author" content="Brutal Pusher">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://brutalpusher.vercel.app">
    
    <!-- Additional Meta Tags -->
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Brutal Pusher - Stop Procrastinating NOW">
    <meta name="twitter:description" content="Your savage AI friend who actually makes you get shit done">
    <meta name="twitter:url" content="https://brutalpusher.vercel.app">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --dark: #1f2937;
            --darker: #111827;
            --light: #f3f4f6;
            --text: #e5e7eb;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text);
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
        }

        .floating {
            position: absolute;
            font-size: 2rem;
            animation: float 20s infinite linear;
            user-select: none;
        }

        @keyframes float {
            from {
                transform: translateY(100vh) translateX(0) rotate(0deg);
            }
            to {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
            }
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            background: linear-gradient(120deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 20px rgba(139, 92, 246, 0.3);
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            font-style: italic;
        }

        /* Mood indicator */
        .mood-indicator {
            margin: 2rem 0;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .mood-text {
            font-size: 1.1rem;
            color: var(--text);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Main card */
        .main-card {
            background: rgba(31, 41, 55, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Input section */
        .input-section {
            margin-bottom: 2rem;
        }

        .input-wrapper {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        input[type="text"] {
            flex: 1;
            padding: 1rem;
            font-size: 1.1rem;
            background: var(--darker);
            border: 2px solid transparent;
            border-radius: 10px;
            color: var(--text);
            transition: all 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }

        button {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: bold;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        button:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0);
            animation: ripple 0.6s ease-out;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Response section */
        .response-section {
            margin-top: 2rem;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

        .response-section.active {
            opacity: 1;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .brutal-response {
            padding: 1.5rem;
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
            border-radius: 10px;
            margin-bottom: 1.5rem;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .brutal-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #fca5a5;
            font-weight: 500;
        }

        /* Task breakdown */
        .task-breakdown {
            margin-top: 2rem;
        }

        .breakdown-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .task-item {
            background: rgba(139, 92, 246, 0.1);
            border-left: 3px solid var(--primary);
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .task-item:hover {
            transform: translateX(5px);
            background: rgba(139, 92, 246, 0.2);
        }

        .task-item.completed {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--success);
            text-decoration: line-through;
            opacity: 0.7;
        }

        .task-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: var(--primary);
            color: white;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-right: 1rem;
            font-weight: bold;
        }

        .task-item.completed .task-number {
            background: var(--success);
        }

        .task-text {
            display: inline-block;
            flex: 1;
        }

        .task-snark {
            display: block;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #a78bfa;
            font-style: italic;
        }

        /* Stats section */
        .stats-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        /* Current momentum display */
        .momentum-display {
            margin-top: 2rem;
            padding: 1rem;
            background: linear-gradient(90deg, var(--danger), var(--warning), var(--success));
            border-radius: 10px;
            text-align: center;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }
            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.8); }
        }

        .momentum-title {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .momentum-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Mobile responsiveness */
        @media (max-width: 640px) {
            h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .input-wrapper {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }

        /* Loading animation */
        .typing-indicator {
            display: inline-block;
        }

        .typing-indicator::after {
            content: '...';
            animation: typing 1.5s infinite;
        }

        @keyframes typing {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--darker);
            color: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Excuse destroyer */
        .excuse-destroyer {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 10px;
            border: 1px dashed var(--danger);
        }

        .excuse-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--darker);
            border: none;
            border-radius: 5px;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .destruction {
            color: #fca5a5;
            font-style: italic;
            animation: fadeIn 0.5s;
            min-height: 1.2rem;
        }

        /* AI Loading State */
        .ai-loading {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
        }

        .loading-dots {
            display: inline-flex;
            gap: 2px;
        }

        .loading-dots span {
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            animation: loadingDots 1.4s infinite ease-in-out;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes loadingDots {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Animated background -->
    <div class="bg-animation" id="bgAnimation"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>BRUTAL PUSHER</h1>
            <p class="tagline">Your AI friend who won't let you BS yourself</p>
        </div>

        <!-- Mood indicator -->
        <div class="mood-indicator">
            <div class="mood-text" id="moodText">
                Oh look, another procrastinator. How original. üôÑ
            </div>
        </div>

        <!-- Main card -->
        <div class="main-card">
            <!-- Input section -->
            <div class="input-section">
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        id="taskInput" 
                        placeholder="What are you avoiding today?"
                        autocomplete="off"
                    >
                    <button id="pushButton" onclick="brutalPush()">
                        Push Me
                    </button>
                </div>
                
                <!-- Excuse destroyer -->
                <div class="excuse-destroyer">
                    <input 
                        type="text" 
                        class="excuse-input"
                        id="excuseInput"
                        placeholder="Type your pathetic excuse here..."
                    >
                    <div class="destruction" id="excuseDestruction"></div>
                </div>
            </div>

            <!-- Response section -->
            <div class="response-section" id="responseSection" style="display: none;">
                <div class="brutal-response">
                    <div class="brutal-text" id="brutalText"></div>
                </div>

                <div class="task-breakdown" id="taskBreakdown"></div>
            </div>

            <!-- Stats section -->
            <div class="stats-section">
                <div class="stat-item">
                    <div class="stat-value" id="tasksCompleted">0</div>
                    <div class="stat-label">Tasks Completed</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="actionsTaken">0</div>
                    <div class="stat-label">Actions Taken</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="currentMomentum">0%</div>
                    <div class="stat-label">Current Momentum</div>
                </div>
            </div>

            <!-- Current momentum display -->
            <div class="momentum-display">
                <div class="momentum-title">Productivity Status</div>
                <div class="momentum-value" id="momentumStatus">Getting Started</div>
            </div>
        </div>
    </div>

    <!-- Toast notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Initialize stats with new simplified tracking
        let stats = {
            tasksCompleted: parseInt(localStorage.getItem('tasksCompleted') || 0),
            actionsTaken: parseInt(localStorage.getItem('actionsTaken') || 0),
            sessionStartTime: Date.now(),
            recentActivity: JSON.parse(localStorage.getItem('recentActivity') || '[]')
        };

        // Calculate current momentum based on recent activity
        function calculateMomentum() {
            const now = Date.now();
            const oneHour = 60 * 60 * 1000;
            const recentActions = stats.recentActivity.filter(time => now - time < oneHour);
            
            // Clean old activity
            stats.recentActivity = recentActions;
            localStorage.setItem('recentActivity', JSON.stringify(stats.recentActivity));
            
            // Calculate momentum percentage (0-100%)
            const momentum = Math.min(100, recentActions.length * 20);
            return momentum;
        }

        // Update momentum status text
        function getMomentumStatus(momentum) {
            if (momentum === 0) return "Getting Started";
            if (momentum < 20) return "Warming Up";
            if (momentum < 40) return "Building Steam";
            if (momentum < 60) return "On Fire! üî•";
            if (momentum < 80) return "Unstoppable Force";
            return "Productivity Beast! üöÄ";
        }

        // Update stats display
        function updateStats() {
            const momentum = calculateMomentum();
            
            document.getElementById('tasksCompleted').textContent = stats.tasksCompleted;
            document.getElementById('actionsTaken').textContent = stats.actionsTaken;
            document.getElementById('currentMomentum').textContent = momentum + '%';
            document.getElementById('momentumStatus').textContent = getMomentumStatus(momentum);
            
            // Save to localStorage
            localStorage.setItem('tasksCompleted', stats.tasksCompleted);
            localStorage.setItem('actionsTaken', stats.actionsTaken);
        }

        // Add activity tracking
        function trackActivity(type = 'action') {
            stats.actionsTaken++;
            stats.recentActivity.push(Date.now());
            
            // Keep only recent activity (last 24 hours)
            const oneDayAgo = Date.now() - (24 * 60 * 60 * 1000);
            stats.recentActivity = stats.recentActivity.filter(time => time > oneDayAgo);
            
            updateStats();
        }

        // Mood messages based on time of day
        function updateMood() {
            const hour = new Date().getHours();
            const moods = {
                morning: [
                    "Rise and shine, sunshine! Just kidding, I know you snoozed 5 times already. üò¥",
                    "Good morning! Or is it afternoon already? Hard to tell with your sleep schedule. ‚è∞",
                    "Another day, another opportunity to disappoint yourself. Let's go! üåÖ"
                ],
                afternoon: [
                    "Half the day gone and you've done... let me guess, nothing? üéØ",
                    "Lunch break over 2 hours ago but here you are. Classic. üçî",
                    "The afternoon slump hits different when you haven't done anything yet, huh? üò™"
                ],
                evening: [
                    "Starting work at night? How very vampire of you. ü¶á",
                    "Oh NOW you're ready to be productive? The sun is literally setting. üåÖ",
                    "Let me guess, you'll 'start fresh tomorrow'? Heard that before. üôÑ"
                ],
                night: [
                    "3AM productivity burst incoming! Too bad you'll sleep through your alarm tomorrow. üåô",
                    "Nothing says 'I have my life together' like starting tasks at midnight. üïê",
                    "Insomnia or procrastination? Why not both! ü¶â"
                ]
            };
            
            let timeOfDay;
            if (hour >= 5 && hour < 12) timeOfDay = 'morning';
            else if (hour >= 12 && hour < 17) timeOfDay = 'afternoon';
            else if (hour >= 17 && hour < 22) timeOfDay = 'evening';
            else timeOfDay = 'night';
            
            const moodArray = moods[timeOfDay];
            const randomMood = moodArray[Math.floor(Math.random() * moodArray.length)];
            
            document.getElementById('moodText').textContent = randomMood;
        }

        // AI functions using your existing Gemini API
        async function callAI(prompt, type = 'task') {
            try {
                const response = await fetch('/api/ai', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json' 
                    },
                    body: JSON.stringify({ 
                        text: prompt,
                        type: type,
                        context: {
                            timeOfDay: new Date().getHours(),
                            momentum: calculateMomentum(),
                            stats: stats
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                return data.response || data.text || data.message || data.data;
            } catch (error) {
                console.error('AI API Error:', error);
                showToast('AI is having a moment. Using backup responses...');
                return getFallbackResponse(prompt, type);
            }
        }

        // Fallback responses when AI is not available
        function getFallbackResponse(prompt, type) {
            if (type === 'excuse') {
                const fallbackExcuses = [
                    "Oh wow, another classic excuse. How original.",
                    "That's cute. Still procrastinating though.",
                    "I've heard that one before. Do the thing anyway.",
                    "Creative excuse! Zero points for execution.",
                    "That excuse expired in 2019. Try again.",
                    "Impressive mental gymnastics. Now do actual gymnastics... with the task.",
                    "Your excuse game is strong. Your follow-through game? Not so much.",
                    "Cool story. Still need to do the thing though."
                ];
                return fallbackExcuses[Math.floor(Math.random() * fallbackExcuses.length)];
            } else {
                const fallbackTasks = [
                    "Oh wow, another task to avoid. Your consistency in procrastination is truly impressive.",
                    "Let me add this to your ever-growing list of things you'll never actually do.",
                    "Sure, let's pretend you'll actually follow through this time. I'll play along.",
                    "I'm breaking this down for you, but we both know you'll find a way to avoid it anyway.",
                    "Alright, let's turn this mountain into molehills so you can ignore smaller things.",
                    "Another day, another task to postpone until the heat death of the universe.",
                    "Your future self is already disappointed, but let's break this down anyway.",
                    "Breaking news: Local procrastinator discovers new task to postpone indefinitely."
                ];
                return fallbackTasks[Math.floor(Math.random() * fallbackTasks.length)];
            }
        }

        // Parse AI response for task breakdown
        function parseAIResponse(response) {
            const lines = response.split('\n').filter(line => line.trim());
            const breakdown = [];
            let roast = '';
            
            for (let line of lines) {
                // Look for numbered steps
                if (line.match(/^\d+[\.\)]\s*/)) {
                    const taskText = line.replace(/^\d+[\.\)]\s*/, '').trim();
                    breakdown.push({
                        task: taskText,
                        snark: "AI-powered procrastination destruction"
                    });
                }
                // Look for bullet points
                else if (line.match(/^[-\*]\s*/)) {
                    const taskText = line.replace(/^[-\*]\s*/, '').trim();
                    breakdown.push({
                        task: taskText,
                        snark: "Because apparently you need this spelled out"
                    });
                }
                // Look for ROAST: prefix from your original format
                else if (line.includes('ROAST:')) {
                    roast = line.replace('ROAST:', '').trim();
                }
                // Capture the main roast (longer lines)
                else if (line.length > 20 && !roast) {
                    roast = line;
                }
            }
            
            // If no structured steps found, create generic ones
            if (breakdown.length === 0) {
                breakdown.push(
                    { task: "Start doing the thing you're avoiding", snark: "Revolutionary concept, I know" },
                    { task: "Continue doing it for 5 minutes", snark: "Baby steps for baby procrastinators" },
                    { task: "Take a break you don't deserve", snark: "Because you definitely earned it" },
                    { task: "Do another 15 minutes", snark: "Look at you, practically functional" },
                    { task: "Actually finish something", snark: "Shocking plot twist" }
                );
            }
            
            return {
                roast: roast || response.split('\n')[0] || response,
                breakdown: breakdown.slice(0, 7) // Limit to 7 steps max
            };
        }

        // Main function with AI integration
        async function brutalPush() {
            const taskInput = document.getElementById('taskInput');
            const task = taskInput.value.trim();
            
            if (!task) {
                showToast("Really? You can't even type what you're avoiding? Peak procrastination.");
                return;
            }
            
            // Disable button and show loading
            const pushButton = document.getElementById('pushButton');
            pushButton.disabled = true;
            pushButton.innerHTML = '<span class="ai-loading">AI is judging you<div class="loading-dots"><span></span><span></span><span></span></div></span>';
            
            // Track activity
            trackActivity('task_start');
            
            // Show response section
            const responseSection = document.getElementById('responseSection');
            responseSection.style.display = 'block';
            responseSection.classList.add('active');
            
            try {
                // Create AI prompt for task analysis
                const momentum = calculateMomentum();
                const aiPrompt = `User wants to tackle this task: "${task}". Their current productivity momentum is ${momentum}%. 

Give them a brutal but motivating response that includes:
1. A sarcastic roast about procrastinating on this specific task (keep under 150 characters)
2. Break it down into 5-7 simple, actionable steps

Be funny and brutal but ultimately helpful. Format your response like:

ROAST: [Your brutal roast here]

1. First specific step
2. Second specific step  
3. Third specific step
etc.

Make the steps actionable and specific to their task. Be savage but supportive!`;

                // Get AI response
                const aiResponse = await callAI(aiPrompt, 'task');
                const parsed = parseAIResponse(aiResponse);
                
                // Display brutal response
                const brutalText = document.getElementById('brutalText');
                typeWriter(brutalText, parsed.roast);
                
                // Generate task breakdown
                setTimeout(() => {
                    displayBreakdown(parsed.breakdown);
                }, 1500);
                
            } catch (error) {
                console.error('Error:', error);
                showToast("Something went wrong. Using backup roasts...");
                
                // Fallback to original behavior
                const brutalText = document.getElementById('brutalText');
                const fallbackResponse = getFallbackResponse(task, 'task');
                typeWriter(brutalText, fallbackResponse);
                
                setTimeout(() => {
                    const breakdown = generateFallbackBreakdown(task);
                    displayBreakdown(breakdown);
                }, 1500);
            } finally {
                // Re-enable button
                pushButton.disabled = false;
                pushButton.innerHTML = 'Push Me';
                taskInput.value = '';
            }
        }

        // Generate fallback task breakdown when AI fails
        function generateFallbackBreakdown(task) {
            const taskLower = task.toLowerCase();
            
            // Basic task categorization
            if (taskLower.includes('study') || taskLower.includes('learn') || taskLower.includes('read')) {
                return [
                    { task: "Find your study materials", snark: "Under that pile of excuses" },
                    { task: "Set a 25-minute timer", snark: "Pomodoro technique for procrastinators" },
                    { task: "Read/study for the full timer", snark: "No phone checking allowed" },
                    { task: "Take a 5-minute break", snark: "You earned this one... barely" },
                    { task: "Do another 25-minute session", snark: "Building that attention span" }
                ];
            } else if (taskLower.includes('work') || taskLower.includes('project') || taskLower.includes('job')) {
                return [
                    { task: "Open your work tools", snark: "Yes, close Instagram first" },
                    { task: "List what needs to be done", snark: "Revolutionary planning concept" },
                    { task: "Pick the easiest task first", snark: "Baby steps for baby procrastinators" },
                    { task: "Work for 15 minutes straight", snark: "Your attention span's current limit" },
                    { task: "Check off what you completed", snark: "Dopamine hit incoming" }
                ];
            } else if (taskLower.includes('clean') || taskLower.includes('organize')) {
                return [
                    { task: "Put on energetic music", snark: "You'll need all the help you can get" },
                    { task: "Pick up 10 things", snark: "Just 10, don't overwhelm yourself" },
                    { task: "Put those things where they belong", snark: "Novel concept, I know" },
                    { task: "Tackle one surface/area", snark: "Remember what clean looks like?" },
                    { task: "Take a before/after photo", snark: "Evidence of your rare productivity" }
                ];
            } else {
                return [
                    { task: "Break the task into smaller pieces", snark: "Bite-sized for your tiny attention span" },
                    { task: "Do just the first small piece", snark: "One step at a time, champion" },
                    { task: "Take a short break", snark: "Because you probably need it" },
                    { task: "Continue with the next piece", snark: "Look at you, building momentum" },
                    { task: "Finish at least half today", snark: "50% is better than your usual 0%" }
                ];
            }
        }

        // AI-powered excuse destroyer with debouncing
        let excuseTimeout;
        document.getElementById('excuseInput').addEventListener('input', async function(e) {
            const excuse = e.target.value.trim();
            const destructionDiv = document.getElementById('excuseDestruction');
            
            if (!excuse) {
                destructionDiv.textContent = '';
                return;
            }
            
            // Clear previous timeout
            clearTimeout(excuseTimeout);
            
            // Show loading
            destructionDiv.innerHTML = '<span class="ai-loading">Analyzing excuse<div class="loading-dots"><span></span><span></span><span></span></div></span>';
            
            // Debounce AI calls
            excuseTimeout = setTimeout(async () => {
                try {
                    const momentum = calculateMomentum();
                    const aiPrompt = `User made this excuse for procrastinating: "${excuse}". Their current momentum is ${momentum}%. Give them a funny, brutal one-liner that destroys their excuse but motivates them. Keep it under 120 characters and be witty but not mean-spirited. Just respond with the roast, nothing else.`;
                    
                    const aiResponse = await callAI(aiPrompt, 'excuse');
                    destructionDiv.textContent = 'üí¢ ' + aiResponse;
                    
                    trackActivity('excuse_destroyed');
                    
                } catch (error) {
                    const fallback = getFallbackResponse(excuse, 'excuse');
                    destructionDiv.textContent = 'üí¢ ' + fallback;
                }
            }, 1200); // Wait 1.2 seconds after user stops typing
        });
        
        // Typewriter effect
        function typeWriter(element, text, speed = 30) {
            element.textContent = '';
            let i = 0;
            
            function type() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            
            type();
        }
        
        // Display task breakdown with animation
        function displayBreakdown(breakdown) {
            const container = document.getElementById('taskBreakdown');
            container.innerHTML = '<h3 class="breakdown-title">Your Pathetically Simple Action Plan:</h3>';
            
            breakdown.forEach((item, index) => {
                setTimeout(() => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    taskItem.innerHTML = `
                        <span class="task-number">${index + 1}</span>
                        <span class="task-text">
                            ${item.task}
                            <span class="task-snark">${item.snark}</span>
                        </span>
                    `;
                    
                    taskItem.addEventListener('click', function() {
                        this.classList.toggle('completed');
                        if (this.classList.contains('completed')) {
                            stats.tasksCompleted++;
                            trackActivity('step_completed');
                            showToast(getCompletionMessage());
                        } else {
                            stats.tasksCompleted = Math.max(0, stats.tasksCompleted - 1);
                            showToast("Unchecking? Can't even commit to checking a box. Typical.");
                        }
                        updateStats();
                    });
                    
                    container.appendChild(taskItem);
                }, index * 200);
            });
        }
        
        // Completion messages
        function getCompletionMessage() {
            const messages = [
                "Holy shit, you actually did something!",
                "Wait... you completed a task? Is this real life?",
                "I'm... actually impressed. Slightly.",
                "Look at you being a functional human!",
                "One small step for you, one giant leap for your productivity.",
                "Did hell freeze over? You finished something!",
                "Mark this day in history - you were productive!",
                "I'm not crying, you're crying. You did it!",
                "Wow, you're slightly less of a disaster today!",
                "Breaking: Local procrastinator shows signs of life!",
                "Achievement unlocked: Basic Human Functionality!",
                "Your future self just breathed a sigh of relief.",
                "Momentum building! Don't stop now, you beautiful disaster."
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }
        
        // Toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3500);
        }
        
        // Ripple effect for button
        function createRipple(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            ripple.classList.add('ripple');
            
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            
            button.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }
        
        // Enter key support
        document.getElementById('taskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                brutalPush();
            }
        });
        
        // Background animation
        function createBackgroundAnimation() {
            const container = document.getElementById('bgAnimation');
            const emojis = ['üò¥', '‚è∞', 'üì±', 'üí§', 'üéÆ', 'üì∫', 'üçï', '‚òï', 'üöÄ', 'üí™', '‚ö°', 'üî•'];
            
            for (let i = 0; i < 12; i++) {
                const floater = document.createElement('div');
                floater.className = 'floating';
                floater.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                floater.style.left = Math.random() * 100 + '%';
                floater.style.animationDelay = Math.random() * 20 + 's';
                floater.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(floater);
            }
        }
        
        // Motivational notifications
        function scheduleNotifications() {
            const notifications = [
                "Still here? Your tasks are getting lonely.",
                "Fun fact: Productivity feels better than scrolling.",
                "Your future self is counting on current you.",
                "Small action > big plan you never execute.",
                "What would productive-you do right now?",
                "Plot twist: You actually CAN do the thing.",
                "Procrastination level: Professional. Time to level up?"
            ];
            
            // Random notification every 25-45 minutes
            setInterval(() => {
                if (Math.random() > 0.6) { // 40% chance
                    const msg = notifications[Math.floor(Math.random() * notifications.length)];
                    showToast(msg);
                }
            }, (25 + Math.random() * 20) * 60 * 1000); // 25-45 minutes
        }
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            updateMood();
            createBackgroundAnimation();
            scheduleNotifications();
            
            // Update mood every hour
            setInterval(updateMood, 3600000);
            
            // Update momentum display every 10 minutes
            setInterval(updateStats, 600000);
            
            // Easter egg: Konami code for motivation boost
            let konamiCode = [];
            const konamiPattern = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'];
            
            document.addEventListener('keydown', function(e) {
                konamiCode.push(e.code);
                konamiCode = konamiCode.slice(-10);
                
                if (konamiCode.join(',') === konamiPattern.join(',')) {
                    document.body.style.animation = 'shake 0.5s';
                    showToast("üéÆ CHEAT CODE ACTIVATED! +50 Momentum!");
                    
                    // Boost momentum temporarily
                    for (let i = 0; i < 3; i++) {
                        stats.recentActivity.push(Date.now() - i * 1000);
                    }
                    updateStats();
                    
                    setTimeout(() => {
                        document.body.style.animation = 'none';
                    }, 500);
                }
            });
            
            // Add button ripple effect
            document.getElementById('pushButton').addEventListener('click', createRipple);
        });
        
        // Random motivational events
        function randomEvents() {
            const events = [
                () => {
                    const momentum = calculateMomentum();
                    if (momentum > 60) {
                        showToast("üî• You're on fire! Keep that momentum going!");
                    } else if (momentum === 0) {
                        showToast("üí§ Wake up, sleepyhead! Your productivity is hibernating.");
                    }
                },
                () => {
                    if (stats.tasksCompleted > 0) {
                        showToast(`üèÜ You've completed ${stats.tasksCompleted} tasks! Your past self is proud.`);
                    }
                },
                () => {
                    const encouragements = [
                        "üí° Reminder: Done is better than perfect!",
                        "‚ö° 2 minutes of action beats 2 hours of planning.",
                        "üéØ What's the smallest thing you could do right now?",
                        "üöÄ Progress, not perfection. You've got this!"
                    ];
                    const msg = encouragements[Math.floor(Math.random() * encouragements.length)];
                    showToast(msg);
                }
            ];
            
            // Trigger random event occasionally
            setTimeout(() => {
                if (Math.random() > 0.85) { // 15% chance
                    const event = events[Math.floor(Math.random() * events.length)];
                    event();
                }
                randomEvents(); // Reschedule
            }, Math.random() * 300000 + 180000); // Random between 3-8 minutes
        }
        
        // Start random events
        setTimeout(randomEvents, 60000); // Start after 1 minute
        
        // Cleanup old localStorage data if needed
        function cleanupOldData() {
            // Remove old unused stats
            localStorage.removeItem('tasksAvoided');
            localStorage.removeItem('excusesMade');
            localStorage.removeItem('currentStreak');
            localStorage.removeItem('lastVisit');
        }
        
        cleanupOldData();
    </script>
</body>
</html>
